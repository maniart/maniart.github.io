<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Empire.js 2018</title>

		<meta name="description" content="diffy.js, empire.js">
		<meta name="author" content="Mani Nilchiani">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="../bower_components/reveal.js/css/reveal.css">
		<link rel="stylesheet" href="../bower_components/reveal.js/css/theme/white.css" id="theme">

		<style type="text/css">
			/* override text styles to monospace */
			body {
				border-top: 20px solid #6b4fff!important;
			}
			.reveal h1,
			.reveal h2,
			.reveal h3,
			.reveal h4,
			.reveal h5,
			.reveal h6,
			.reveal ul,
			.reveal ol {
				font-family: Consolas, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", "Nimbus Mono L", Monaco, "Courier New", Courier, monospace;
				letter-spacing: -4px;
				text-decoration: underline;
				width: 100%;
			}
			.reveal p,
			.reveal small {
				font-family: Consolas, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", "Nimbus Mono L", Monaco, "Courier New", Courier, monospace;
				letter-spacing: -4px;
			}
			.reveal a {
				color: #6b4fff;
				border-bottom: 2px solid #6b4fff; 
			}
			.reveal a:hover {
				background-color: #6b4fff;
				color: white; 
			}
			.reveal ul, 
			.reveal ol {
				text-decoration: none;
				letter-spacing: 0.01em;
			}
			.reveal section img {
				border: none;
				box-shadow: none;
			}
			.reveal .controls div.navigate-right, .reveal .controls div.navigate-right.enabled {
				border-left-color: #6b4fff;
			}
			.reveal .controls div.navigate-left, .reveal .controls div.navigate-left.enabled {
				border-right-color: #6b4fff;
			}
			.reveal small {
				font-size: 0.4em;
				letter-spacing: -1px;
			}
			.wasm {
				color: #6b4fff!important;
			}
			.font-small {
				font-size: 0.7em!important;
			}
			.reveal .progress span {
				background-color: #6b4fff!important;
			}
			.left {
				float: left;
				text-align: left;
			}
			.border-wasm {
				border-bottom: 10px solid #6b4fff!important;
				border-left: 5px solid #6b4fff!important; 
				border-top: 1px solid #6b4fff!important; 
				border-right: 1px solid #6b4fff!important; 
			}
			.credit {
				float: left;
				clear: both;
			}
			.clearfix {
				clear: both!important;
			}
			.no-margin {
				margin: 0!important;
			}
		</style>

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="../bower_components/reveal.js/lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			document.write( '<link rel="stylesheet" href="../bower_components/reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section>
					<h3>Webassembly for performant interactivity</h3>
					<div style="text-align: center;">
						<img 
							style="width: 200px;" 
							src="./assets/wasm-logo.png">
					</div>
					<br>
					<br>
					<small>Mani Nilchiani, Empire.js 2018</small>
				</section>

				<section>
					<h3 class="wasm"> Hello! </h3>
					<img 
							style="width: 200px;" 
							src="./assets/me.jpg">
					<p class="font-small wasm">
						My name is Mani.
						I'm a technologist, artist &amp; musician, <br> currently working out of Pioneer Works tech lab on a VR interactive narrative.
					</p>
				</section>

				<section>
					<h3 class="wasm left">Structure of this talk</h3>
					<ul class="font-small left">
						<li>Software art</li>
						<li>Making tools</li>
						<li>Browser as platform</li>
						<li>Diffy.js</li>
						<li>Performance improvements</li>
						<li>Going low-level</li>
						<li>From Rust to JS via WASM</li>
					</ul>
				</section>

				<section>
					<h3 class="wasm left">Software art</h3>
					<p class="left font-small">Procedural thinking, Interaction Design</p>
				</section>

				<section>
					<h3 class="wasm left">Vera Molnar</h3>
					<img height="500px" class="left border-wasm" src="./assets/molnar-portrait.png">
				</section>

				<section>
					<img height="500px" src="./assets/molnar-1.png">
				</section>

				<section>
					<img height="500px" src="./assets/molnar-2.png">
				</section>

				<section>
					<h3 class="wasm left">Manfred Mohr</h3>
					<img height="500px" class="left border-wasm" src="./assets/mohr-portrait.png">
				</section>

				<section>
					<img height="500px" src="./assets/mohr-1.png">
				</section>

				<section>
					<img height="500px" src="./assets/mohr-2.png">
				</section>

				<section>
					<h3 class="wasm left">Camille Utterback</h3>
					<img height="500px" class="border-wasm left" src="./assets/camille.jpg">
				</section>

				<section>
					<img height="500px" src="./assets/text-rain.gif">
				</section>

				<section>
					<h3 class="wasm left">Golan Levin &amp; Collaborators</h3>
					<img class="left border-wasm" height="500px" src="./assets/golan.jpeg">
				</section>

				<section>
					<img height="500px" src="./assets/mesa-di-voce.gif">
				</section>

				<section>
					<h3 class="wasm left">Posenet</h3>
					<img class="left border-wasm" height="500px" src="./assets/posenet.gif">
					<small class="credit"><a href="https://medium.com/tensorflow/real-time-human-pose-estimation-in-the-browser-with-tensorflow-js-7dd0bc881cd5">Source</a></small>
				</section>

				<section>
					<h3 class="wasm left">Making tools for art</h3>
					<img class="left" height="500px" src="./assets/tools-logos.jpg">
					<small class="credit">
						[clockwise from the top] 
						<a href="http://processing.org">Processing</a>
						<a href="http://openframeworks.cc">OpenFrameworks</a>
						<a href="https://p5js.org/">P5.js</a>
					</small>
				</section>

				<section>
					<h3 class="wasm left">Diffy.js</h3>
					<img class="left" height="200px" src="./assets/diffy-logo.jpg">
					<small class="credit">Motion detection for the browser <a href="https://github.com/maniart/diffyjs">Repo</a></small>
				</section>

				<section>
					<h3 class="wasm left">Diffy.js</h3>
					<ul class="font-small left">
						<li>
							Where did motion happen?
						</li>
						<li>
							How much?
						</li>
					</ul>
				</section>

				<section>
					<h3 class="wasm left">ArrayBuffer and TypedArray</h3>
					<small class="left wasm">I wonder what unsigned integers clamped at 255 can represent</small>
<pre class="clearfix border-wasm clearfix no-margin"><code class="" data-trim>
drawBlendImageFromBuffer(buffer) {
  this.blendImageData
    .data
    .set(
      new Uint8ClampedArray(buffer)
    );

  this.blendCanvasCtx.putImageData(this.blendImageData, 0, 0);
  this.previousImageData = this.currentImageData;
}

</code></pre>
				</section>

				<section>
					<h3 class="wasm left">Bitwise</h3>
<pre class="clearfix border-wasm clearfix no-margin"><code data-trim>

// bitwise Math.round
export const round = (number) => (number + .5) >> 0;

// butwise Math.abs
export const abs = (value) => (value ^ (value >> 31)) - (value >> 31);

</code></pre>
				</section>

				<section>
					<h3 class="wasm left">What Diffy does</h3>
					<img class="left border-wasm" height="500" src="./assets/undoing.gif">
					<small class="credit">"On doing and un-doing" <a href="https://mani.io/portfolio/on-doing-and-un-doing/">About</a></small>
				</section>

				<section>
					<h3 class="wasm left">What Diffy does contd.</h3>
					<img class="left border-wasm" height="500" src="./assets/undoing-2.jpg">
					<small class="credit">"On doing and un-doing" <a href="https://mani.io/portfolio/on-doing-and-un-doing/">About</a></small>
				</section>

				<section>
					<h3 class="wasm left">What Diffy does contd.</h3>
					<img class="left border-wasm" height="500" src="./assets/game.gif">
					<small class="credit">Point it out <a href="https://point-it-out.herokuapp.com/home">Launch</a></small>
				</section>

				<section>
				<h3 class="wasm left">What Diffy does contd.</h3>
<pre class="border-wasm clearfix no-margin"><code data-trim>
import { create } from 'diffyjs';

const diffy = create({
  resolution: { x: 15, y: 10 },
  sensitivity: 0.2,
  threshold: 25,
  debug: true,
  containerClassName: 'my-diffy-container',
  sourceDimensions: { w: 130, h: 100 },
  onFrame: (matrix) => { /* stuff */ }
});
</code></pre>
				</section>

				<section>
					<h3 class="wasm left">Diagram time</h3>
					<img class="left border-wasm" height="500" src="./assets/diagram.png">
				</section>

<section>
				<h3 class="wasm left">Worker</h3>
<pre class="border-wasm clearfix no-margin"><code data-trim>
compare(frame1, frame2) {
  const data1 = frame1.data;
  const data2 = frame2.data;
  const length = data1.length;
  const buffer = new ArrayBuffer(length);

  this.worker.postMessage({
    buffer,
    data1,
    data2,
    sensitivity: this.sensitivity,
    threshold: this.threshold,
    width: this.sourceWidth,
    height: this.sourceHeight
  });
}
</code></pre>
				</section>

				<section>
					<h3 class="wasm left">Performance bottleneck</h3>
					<p class="left font-small">Diffy won't scale well on larger matrices, <br>because the Big-O time complexity is O(nÂ²)</p>
				</section>

				<section>
					<h3 class="wasm left">Raytracing example</h3>
					<img class="left border-wasm" height="500" src="./assets/ray.gif">
					<small><a href="https://github.com/mtharrison/wasm-raytracer">Source</a></small>
				</section>

				<section>
					<h3 class="wasm left">What exactly is wasm</h3>
					<ul class="font-small">
						<li>Binary instruction format</li>
						<li>Portable target for compilation of high-level languages like C/C++/Rust</li>
						<li>Web assembly makes it possible for library authors and application developers to code in languages that are more consistently performant but then to have that code run on the web just like JavaScript does; And to integrate with existing JS</li>
						<li>Shares memory with JS (ArrayBuffers)</li>
					</ul>
				</section>

				<section>
					<h3 class="wasm left">Is it going to Kill JS?</h3>
					<p class="left font-small">Why can't we be friends?</p>
				</section>

				<section>
					<h3 class="wasm left">What existed before</h3>
					<p class="wasm left">
						asm.js is a subset of JavaScript designed to allow computer software written in languages such as C to be run as web applications while maintaining performance characteristics considerably better than standard JavaScript, the typical language used for such applications
					</p>
				</section>

				<section>
					<h3 class="wasm left">Why is wasm faster?</h3>
					<ul class="font-small">
						<li>It takes less time to download because it is more compact</li>
						<li>It is faster to parse. JS is parsed from source into AST, and then to an intermediary representation called "Byte code" which is specific to the JS runtime we use. WebAssembly only needs to be decoded, and decoding is faster than parsing.</li>
						<li>Compilation happens ahead of time, before the file was uploaded, no JIT necessary</li>
						<li>we don't need to worry about Garbage Collection because languages that target WebAssembly use manual memory management.</li>
						<li>wasm only supports number data types.</li>
					</ul>
				</section>

				<section>
					<h3 class="wasm left">
						Rust
					</h3>

					<p class="wasm left">
						Rust is a systems programming language sponsored by Mozilla which describes it as a "safe, concurrent, practical language," supporting functional and imperative-procedural paradigms.
					</p>
				</section>

				<section>
					<h3 class="wasm left">Starting with Rust</h3>
<pre class="border-wasm clearfix no-margin"><code data-trim>
> cargo new my-awesome-project
	Created binary (application) `my-awesome-project` project
</code></pre>
				</section>
				
				<section>
					<h3 class="wasm left">Project scaffolding</h3>
					<img class="left border-wasm" height="500" src="./assets/rust-scaffold.png">
				</section>

				<section>
					<h3 class="wasm left">Dependencies</h3>
					<img class="left border-wasm" height="500" src="./assets/toml.png">
				</section>

				<section>
					<h3 class="wasm left">main.rs</h3>
					<img class="left border-wasm" height="500" src="./assets/main-rs.png">
				</section>

				<section>
					<h3 class="wasm left">Build & Execute</h3>
<pre class="border-wasm clearfix no-margin"><code data-trim>
> cargo run
     Compiling my-awesome-project v0.1.0 (file:///Users/maninilchiani/Workspace/rust/my-awesome-project)
     Finished dev [unoptimized + debuginfo] target(s) in 1.62s
     Running `target/debug/my-awesome-project`
Hello, world!
</code></pre>
				</section>

				<section>
					<h3 class="wasm left">Build</h3>
					<img class="left border-wasm" height="500" src="./assets/build.png">
				</section>

				<section>
					<h3 class="wasm left">wasm-bindgen</h3>
					<p class="left font-small">
						Facilitates high-level interactions between wasm modules and JavaScript. 
						Generates glue code for JS and Rust interoperability.	
					</p>
					
				</section>
				
				<section>
					<h3 class="wasm left">wasm-bindgen</h3>
					<img class="left border-wasm" height="500" src="./assets/wasm-bindgen.png">
				</section>

				<section>
					<h3 class="wasm left">build</h3>
					<img class="left border-wasm" height="500" src="./assets/build-sh.png">
				</section>

				<section>
					<h3 class="wasm left">lib.rs</h3>
					<img class="left border-wasm" height="500" src="./assets/lib.png">
				</section>

				<section>
					<h3 class="wasm left">package.json</h3>
					<img class="left border-wasm" height="500" src="./assets/package.png">
				</section>

				<section>
					<h3 class="wasm left">Webpack Config</h3>
					<img class="left border-wasm" height="500" src="./assets/webpack.png">
				</section>

				<section>
					<h3 class="wasm left">index.js</h3>
					<img class="left border-wasm" height="500" src="./assets/index.png">
				</section>

				<section>
					<h3 class="wasm left">The "glue"</h3>
					<img class="left border-wasm" height="500" src="./assets/glue.png">
				</section>

				<section>
					<h3 class="wasm left">Closing the loop</h3>
					<img class="left border-wasm" height="500" src="./assets/alert.png">
				</section>

				<section>
					<h3 class="wasm left">Should we use WASM for everything?</h3>
					<p class="wasm left">I mean, we *can*</p>
				</section>

				<section>
					<h3 class="wasm">Thank You!</h3>
					<small class=""><a href="http://mani.io">mani.io</a></small>
				</section>

				<section>
					<h3 class="wasm left">Resources</h3>
					<ul class="font-small left">
						<li>
							<a href="https://github.com/rustwasm/wasm-bindgen">wasm-bindgen</a>
						</li>
							<li>
								<a href="https://hacks.mozilla.org/2017/02/what-makes-webassembly-fast/">What makes wasm fast</a></li>
							<li>
								<a href="https://hacks.mozilla.org/2017/02/a-cartoon-intro-to-webassembly/">A cartoon intro to wasm</a></li>
							<li>
								<a href="https://www.youtube.com/watch?v=DKHuEkmsx3M">WebAssembly In Action</a></li>
							<li>
								<a href="https://hacks.mozilla.org/2018/04/hello-wasm-pack/">Hello wasm-pack</a></li>
							<li>
								<a href="https://rustwasm.github.io/wasm-bindgen/">wasm-bindgen</a></li>
							<li>
								<a href="https://hacks.mozilla.org/2018/06/babys-first-rustwebassembly-module-say-hi-to-jsconf-eu/">bb's first rust wasm module</a></li>
							<li>
								<a href="https://blog.ryanlevick.com/posts/wasm-bindgen-interop/">wasm-bindgen interop</a></li>
							<li>
								<a href="http://matt-harrison.com/raytracing-webassembly-vs-javascript/">ray tracing: wasm vs js</a></li>
							<li>
								<a href="https://github.com/mtharrison/wasm-raytracer">wasm raytracer</a></li>
							<li>
								<a href="https://www.youtube.com/watch?v=BnYq7JapeDA">Build the future of the web with WebAssembly and more (Google I/O '18)
</a></li>
					</ul>
				</section>

			</div>



		</div>

		<script src="../bower_components/reveal.js/lib/js/head.min.js"></script>
		<script src="../bower_components/reveal.js/js/reveal.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,
				slideNumber: true,
				theme: Reveal.getQueryHash().theme || 'night', // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: '../bower_components/reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../bower_components/reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../bower_components/reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../bower_components/reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '../bower_components/reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: '../bower_components/reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
